<HTML>
<TITLE>CM1:  Known Problems and Fixes</TITLE>
<BODY>
<p>
<center>
  <font size=+2><b>Known CM1 Problems and Fixes</b></font><br>
  <font color="red">Valid for cm1r18</font> (which was released 14 August 2015)
</center>
<p>
<b>1.  Distributed memory (MPI) runs in 2D</b>  (first posted: 14 August 2006)  (applies to ALL releases of cm1)
<p>
CM1 does not work properly for 2d runs with MPI (i.e., distributed memory).  MPI should not be used for 2D simulations until further notice.  [There are no problems with single-processor runs or OpenMP (shared memory) runs.  There are no problems with 3D runs with MPI.]
<p>
Updated, 12 August 2008:  This problem also applies to axisymmetric simulations.  Do not run axisymmetric simulations with MPI. 
<p>
<hr>
<p>
<center><b>Known Problems in earlier versions of CM1</b></center>
<p>
<b>Known problems in <font color="red">cm1r8 - cm1r15</font>:</b> (posted 5 January 2012)
<p>
<b>1.  There is a bug with vertically stretched grids using terrain.</b>  This bug does not affect simulations without terrain, and it only affects simulations with terrain that use vertically stretched grids (stretch_z = 1). 
<p>
Solution:  download the following files and place them in the "src" directory.  The re-compile and re-run cm1.
<p>
Files for cm1r15:
<ul>
  <li><a href="cm1r15_fixed/solve.F">solve.F</a>
  <li><a href="cm1r15_fixed/sound.F">sound.F</a>
  <li><a href="cm1r15_fixed/sounde.F">sounde.F</a>
</ul>
<p>
Files for cm1r14:
<ul>
  <li><a href="cm1r14_fixed/solve.F">solve.F</a>
  <li><a href="cm1r14_fixed/sound.F">sound.F</a>
  <li><a href="cm1r14_fixed/sounde.F">sounde.F</a>
  <li><a href="cm1r14_fixed/thompson.F">thompson.F</a>
  <li><a href="cm1r14_fixed/morrison.F">morrison.F</a>
</ul>
<p>
Files for cm1r13:
<ul>
  <li><a href="cm1r13_fixed/solve.F">solve.F</a>
  <li><a href="cm1r13_fixed/sound.F">sound.F</a>
  <li><a href="cm1r13_fixed/sounde.F">sounde.F</a>
</ul>
<p>
Files for cm1r12:
<ul>
  <li><a href="cm1r12_fixed/solve.F">solve.F</a>
  <li><a href="cm1r12_fixed/sound.F">sound.F</a>
  <li><a href="cm1r12_fixed/sounde.F">sounde.F</a>
</ul>
<p>
<p>
To reiterate:  this bug only affects runs with terrain (terrain_flag = .true.) and only when using a vertically stretched grid (stretch_z = 1).  
<p>
----------------
<p>
<b>Known problems in <font color="red">cm1r14</font>:</b> (posted 12 January 2011)
<p>
<b>1.  Thompson and Morrison microphysics (only if neweqts=1,2):</b>  There is a bug with the implementation of the mass- and energy-conserving equations for the Thompson (ptype=3) and Morrison (ptype=5) microphysics schemes in cm1r14.  There is no problem if neweqts=0 ("traditional" equation set).  This bug <i>only</i> impacts the Thompson and Morrison microphysics schemes (ptype = 3 and 5, respectively).
<p>
Solution:  download the following files and place them in the "src" directory.  Then re-compile and re-run.  (For cm1r14 only.)
<ul>
  <li><a href="cm1r14_fixed/solve.F">solve.F</a>
  <li><a href="cm1r14_fixed/thompson.F">thompson.F</a>
  <li><a href="cm1r14_fixed/morrison.F">morrison.F</a>
</ul>
<p>
Explanation:  there was an "order-of-operations" error, wherein the old pressure and the new temperature were used to calculate the new value of potential temperature.  This bug caused cold pools to be too strong (by ~15% at the lowest model level) in idealized simulations of midlatitude squall lines.  The magnitude of errors in other phenomena (e.g., supercells, hurricanes) is unknown at this time.  Users of cm1r14 are encouraged to download the modified code (above) and re-run their simulations.
<p>
To reiterate:  this bug only affects cm1r14, and it only affects the Thompson and Morrison microphysics schemes if neweqts=1 or neweqts=2. 
<p>
<hr>
<p>
Send comments and/or questions about this page to:<br>
<p>
George H. Bryan<br>
National Center for Atmospheric Research<br>
3450 Mitchell Lane<br>
Boulder, CO 80301, USA<br>
email: gbryan at ucar.edu
<p>
<i>Last updated:  6 February 2012</i>
</BODY>
</HTML>
